<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.inno72.mapper.Inno72OrderMapper">
    <resultMap id="BaseResultMap" type="com.inno72.model.Inno72Order">
        <!--
          WARNING - @mbg.generated
        -->
        <id column="id" jdbcType="VARCHAR" property="id"/>
        <result column="order_num" jdbcType="VARCHAR" property="orderNum"/>
        <result column="user_id" jdbcType="VARCHAR" property="userId"/>
        <result column="channel_id" jdbcType="VARCHAR" property="channelId"/>
        <result column="machine_id" jdbcType="VARCHAR" property="machineId"/>
        <result column="shops_id" jdbcType="VARCHAR" property="shopsId"/>
        <result column="shops_name" jdbcType="VARCHAR" property="shopsName"/>
        <result column="merchant_id" jdbcType="VARCHAR" property="merchantId"/>
        <result column="inno72_activity_id" jdbcType="VARCHAR" property="inno72ActivityId"/>
        <result column="inno72_activity_plan_id" jdbcType="VARCHAR" property="inno72ActivityPlanId"/>
        <result column="order_time" jdbcType="TIMESTAMP" property="orderTime" javaType="java.time.LocalDateTime"
                typeHandler="org.apache.ibatis.type.LocalDateTimeTypeHandler"/>
        <result column="order_price" jdbcType="DECIMAL" property="orderPrice"/>
        <result column="pay_price" jdbcType="DECIMAL" property="payPrice"/>
        <result column="order_type" jdbcType="TINYINT" property="orderType"/>
        <result column="pay_status" jdbcType="TINYINT" property="payStatus"/>
        <result column="goods_status" jdbcType="TINYINT" property="goodsStatus"/>
        <result column="pay_time" jdbcType="TIMESTAMP" property="payTime" javaType="java.time.LocalDateTime"
                typeHandler="org.apache.ibatis.type.LocalDateTimeTypeHandler"/>
        <result column="ref_order_status" jdbcType="VARCHAR" property="refOrderStatus"/>
        <result column="ref_order_id" jdbcType="VARCHAR" property="refOrderId"/>
        <result column="repetition" jdbcType="TINYINT" property="repetition"/>
    </resultMap>
    <select id="selectByRefOrderId" parameterType="java.lang.String" resultMap="BaseResultMap">
  	select * from inno72_order where ref_order_id = #{orderId}
  </select>
    <select id="findGoodsStatusSucc" resultMap="BaseResultMap" parameterType="java.util.Map">
        select * from inno72_order
        where inno72_activity_plan_id = #{activityPlanId}
        and user_id = #{gameUserId}
        and goods_status = 1
        <if test="orderTime != null and orderTime != ''">
            and DATE_FORMAT(order_time, '%Y-%m-%d') = CURDATE()
        </if>
    </select>
</mapper>